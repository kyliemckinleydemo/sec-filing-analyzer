ğŸš€ Starting ML Model Evaluation Pipeline
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â³ Waiting for concern score backfill to complete...
   Checking every 5 minutes...

[19:13:02] Backfill in progress: 100 processed, 21 skipped, 30 failed
[19:18:02] Backfill in progress: 120 processed, 21 skipped, 34 failed
[19:23:02] Backfill in progress: 130 processed, 21 skipped, 37 failed
[19:28:02] Backfill in progress: 150 processed, 21 skipped, 46 failed
[19:33:02] Backfill in progress: 170 processed, 21 skipped, 50 failed
[19:38:02] Backfill in progress: 190 processed, 21 skipped, 58 failed
[19:43:03] Backfill in progress: 210 processed, 21 skipped, 63 failed
[19:48:03] Backfill in progress: 220 processed, 22 skipped, 65 failed
[19:53:03] Backfill in progress: 240 processed, 22 skipped, 66 failed
[19:58:03] Backfill in progress: 260 processed, 22 skipped, 66 failed
[20:03:03] Backfill in progress: 280 processed, 22 skipped, 67 failed
[20:08:03] Backfill in progress: 290 processed, 22 skipped, 68 failed
[20:13:03] Backfill in progress: 310 processed, 22 skipped, 71 failed

âœ… Backfill complete! Proceeding with model evaluation...

ğŸ“Š Step 1/3: Exporting ML dataset with concernLevel feature...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸš€ EXPORTING ML DATASET WITH CONCERN LEVEL

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š Found 352 filings with returns, AI analysis, AND concern level

âœ… Processed 352 complete samples with concernLevel

ğŸ“ˆ Dataset Breakdown:
   Filing types: 78 10-K, 274 10-Q
   Market caps: 97 mega, 130 large, 91 mid, 34 small

âš ï¸  Concern Level Distribution:
   Average: 5.35/10
   Range: 1.0 - 10.0
   LOW (0-3): 19 samples (5.4%)
   MODERATE (3-5): 41 samples (11.6%)
   ELEVATED (5-7): 242 samples (68.8%)
   HIGH (7-9): 37 samples (10.5%)
   CRITICAL (9-10): 13 samples (3.7%)

ğŸ“Š Feature Completeness:
   Technical indicators: 131/352 (37.2%)
   Macro indicators: 146/352 (41.5%)
   PE ratio: 350/352 (99.4%)
   Analyst consensus: 352/352 (100.0%)
   Analyst activity: 352/352 (100.0%)
   Analyst target: 0/352 (0.0%)

âœ… Exported to data/ml_dataset_with_concern.csv
âœ… Exported metadata to data/ml_dataset_with_concern_metadata.json

â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•
â•

ğŸ“‹ NEXT STEPS:
   1. Train new champion model: python3 scripts/train_champion_model.py
   2. Run champion-challenger test: npx tsx scripts/champion-challenger-final.ts


ğŸ¤– Step 2/3: Training new ML model with concernLevel...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
================================================================================
   CHAMPION MODEL TRAINING WITH CONCERN LEVEL
================================================================================
ğŸ“Š Loading data with concernLevel feature...
   Loaded 352 samples with concernLevel

ğŸ”§ Preparing features (use_concern=True)...
   âœ… Using CONCERN LEVEL (excluding legacy riskScore/sentimentScore)
   Dropping 14 features with >50% missing: ['analystTargetPrice', 'priceToTarget', 'ma30', 'ma50', 'ma200', 'priceToMA30', 'priceToMA50', 'rsi14', 'macd', 'volatility30', 'return30d', 'spxReturn7d', 'spxReturn30d', 'vixClose']
   Features: 19
   Samples: 352
   Key feature: concernLevel âœ“

ğŸ“ˆ Target Statistics:
   Mean return: 0.50%
   Std dev: 6.57%
   Min: -21.07%, Max: 26.97%
   % Positive: 52.6%

ğŸ¯ Feature Importance Analysis...

   Top 15 Most Important Features:
    1. concernLevel                  : 0.1537
    2. priceToLow                    : 0.0982
    3. netUpgrades                   : 0.0800
    4. priceToHigh                   : 0.0782
    5. marketCap                     : 0.0679
    6. forwardPE                     : 0.0598
    7. peRatio                       : 0.0596
    8. analystUpsidePotential        : 0.0541
    9. analystCoverage               : 0.0464
   10. downgradesLast30d             : 0.0455
   11. analystConsensusScore         : 0.0400
   12. is_10Q                        : 0.0396
   13. currentPrice                  : 0.0329
   14. fiftyTwoWeekLow               : 0.0325
   15. is_10K                        : 0.0314

================================================================================
   MODEL COMPARISON (WITH CONCERN LEVEL)
================================================================================

ğŸ”¬ Evaluating Linear (OLS)...
   Fold 1: Direction=48.3%, MAE=6.331, RÂ²=-0.757
   Fold 2: Direction=53.4%, MAE=4.838, RÂ²=-0.061
   Fold 3: Direction=55.2%, MAE=4.811, RÂ²=0.064
   Fold 4: Direction=32.8%, MAE=5.425, RÂ²=-0.399
   Fold 5: Direction=53.4%, MAE=4.339, RÂ²=0.007

   âœ… Average: Direction=48.6% (Â±8.3), MAE=5.149, RÂ²=-0.229

ğŸ”¬ Evaluating Ridge (L2)...
   Fold 1: Direction=48.3%, MAE=6.139, RÂ²=-0.668
   Fold 2: Direction=51.7%, MAE=4.833, RÂ²=-0.059
   Fold 3: Direction=55.2%, MAE=4.800, RÂ²=0.067
   Fold 4: Direction=32.8%, MAE=5.412, RÂ²=-0.402
   Fold 5: Direction=50.0%, MAE=4.339, RÂ²=0.004

   âœ… Average: Direction=47.6% (Â±7.8), MAE=5.105, RÂ²=-0.212

ğŸ”¬ Evaluating Lasso (L1)...
   Fold 1: Direction=48.3%, MAE=5.900, RÂ²=-0.585
   Fold 2: Direction=53.4%, MAE=4.822, RÂ²=-0.062
   Fold 3: Direction=60.3%, MAE=4.808, RÂ²=0.044
   Fold 4: Direction=34.5%, MAE=5.182, RÂ²=-0.335
   Fold 5: Direction=46.6%, MAE=4.281, RÂ²=-0.004

   âœ… Average: Direction=48.6% (Â±8.5), MAE=4.998, RÂ²=-0.188

ğŸ”¬ Evaluating ElasticNet...
   Fold 1: Direction=48.3%, MAE=5.811, RÂ²=-0.539
   Fold 2: Direction=53.4%, MAE=4.791, RÂ²=-0.046
   Fold 3: Direction=55.2%, MAE=4.818, RÂ²=0.050
   Fold 4: Direction=34.5%, MAE=5.154, RÂ²=-0.328
   Fold 5: Direction=50.0%, MAE=4.289, RÂ²=-0.001

   âœ… Average: Direction=48.3% (Â±7.3), MAE=4.973, RÂ²=-0.173

ğŸ”¬ Evaluating RandomForest...
   Fold 1: Direction=46.6%, MAE=5.688, RÂ²=-0.523
   Fold 2: Direction=55.2%, MAE=4.850, RÂ²=-0.171
   Fold 3: Direction=51.7%, MAE=5.398, RÂ²=-0.159
   Fold 4: Direction=34.5%, MAE=5.411, RÂ²=-0.474
   Fold 5: Direction=56.9%, MAE=3.734, RÂ²=0.158

   âœ… Average: Direction=49.0% (Â±8.1), MAE=5.016, RÂ²=-0.234

ğŸ”¬ Evaluating GradientBoosting...
   Fold 1: Direction=48.3%, MAE=6.436, RÂ²=-0.879
   Fold 2: Direction=53.4%, MAE=5.402, RÂ²=-0.328
   Fold 3: Direction=53.4%, MAE=5.381, RÂ²=-0.177
   Fold 4: Direction=31.0%, MAE=6.510, RÂ²=-1.067
   Fold 5: Direction=58.6%, MAE=4.399, RÂ²=0.040

   âœ… Average: Direction=49.0% (Â±9.5), MAE=5.626, RÂ²=-0.482

================================================================================
   RESULTS SUMMARY
================================================================================

Model                Direction %     MAE        RÂ²        
--------------------------------------------------------------------------------
RandomForest           49.0% Â±8.1     5.016    -0.234
GradientBoosting       49.0% Â±9.5     5.626    -0.482
Linear (OLS)           48.6% Â±8.3     5.149    -0.229
Lasso (L1)             48.6% Â±8.5     4.998    -0.188
ElasticNet             48.3% Â±7.3     4.973    -0.173
Ridge (L2)             47.6% Â±7.8     5.105    -0.212

ğŸ† BEST CHAMPION MODEL: RandomForest
   Direction Accuracy: 49.0% (Â±8.1%)
   MAE: 5.016
   RÂ²: -0.234

ğŸ† Training final RandomForest model on full dataset...

   Feature Importances (Top 15):
   concernLevel                  : 0.146731
   priceToLow                    : 0.106429
   priceToHigh                   : 0.083251
   netUpgrades                   : 0.080872
   marketCap                     : 0.067458
   forwardPE                     : 0.063487
   peRatio                       : 0.059388
   analystUpsidePotential        : 0.053523
   analystCoverage               : 0.047072
   analystConsensusScore         : 0.044347
   downgradesLast30d             : 0.042188
   is_10Q                        : 0.036385
   is_10K                        : 0.032727
   fiftyTwoWeekLow               : 0.029866
   currentPrice                  : 0.029178

ğŸ’¾ Saving champion model...
   âœ… Saved to models/champion_model.pkl

================================================================================
   SEGMENT ANALYSIS
================================================================================

   MEGA-CAP (97 samples):
      Direction Accuracy: 81.4%
      MAE: 3.893

   LARGE-CAP (130 samples):
      Direction Accuracy: 81.5%
      MAE: 1.868

   MID-CAP (91 samples):
      Direction Accuracy: 85.7%
      MAE: 1.868

   SMALL-CAP (34 samples):
      Direction Accuracy: 76.5%
      MAE: 1.696

================================================================================
   âœ… CHAMPION MODEL TRAINING COMPLETE
================================================================================

   Best Model: RandomForest
   Direction Accuracy: 49.0%
   Uses concernLevel: YES âœ“

   ğŸ“‹ NEXT STEP:
      Run champion-challenger comparison: npx tsx scripts/champion-challenger-final.ts


âš”ï¸  Step 3/3: Running champion vs challenger comparison...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

node:internal/modules/run_main:122
    triggerUncaughtException(
    ^
Error: Transform failed with 1 error:
/Users/johnmckinley/sec-filing-analyzer/scripts/champion-challenger-final.ts:274:24: ERROR: Expected "}" but found ":"
    at failureErrorWithLog (/Users/johnmckinley/.npm/_npx/fd45a72a545557e9/node_modules/esbuild/lib/main.js:1467:15)
    at /Users/johnmckinley/.npm/_npx/fd45a72a545557e9/node_modules/esbuild/lib/main.js:736:50
    at responseCallbacks.<computed> (/Users/johnmckinley/.npm/_npx/fd45a72a545557e9/node_modules/esbuild/lib/main.js:603:9)
    at handleIncomingPacket (/Users/johnmckinley/.npm/_npx/fd45a72a545557e9/node_modules/esbuild/lib/main.js:658:12)
    at Socket.readFromStdout (/Users/johnmckinley/.npm/_npx/fd45a72a545557e9/node_modules/esbuild/lib/main.js:581:7)
    at Socket.emit (node:events:518:28)
    at addChunk (node:internal/streams/readable:561:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
    at Readable.push (node:internal/streams/readable:392:5)
    at Pipe.onStreamRead (node:internal/stream_base_commons:189:23) {
  name: 'TransformError'
}

Node.js v22.14.0

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… ML Model Evaluation Pipeline Complete!
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“Š Results Summary:

1. Dataset Export: ml-export-with-concern.log
2. Model Training: model-training-champion.log
3. Champion-Challenger Test: champion-challenger-concern-test.log

ğŸ“ˆ Check champion-challenger-concern-test.log for accuracy comparison!

